<!doctype html>
<html lang="ja"><!-- InstanceBegin template="/Templates/reference2020.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- InstanceBeginEditable name="doctitle" -->
	<title>WindowsMediaPlayer部品</title>
<!-- InstanceEndEditable -->
	<link href="../../css/bootstrap.min.css" rel="stylesheet">
	<link href="../../css/style.css" rel="stylesheet">
	<link href="../../css/ie10-viewport-bug-workaround.css" rel="stylesheet">
	<script src="../../js/html5shiv-3.7.3.min.js"></script>
	<script src="../../js/respond-1.4.2.min.js"></script>
<!-- InstanceBeginEditable name="head" -->
<meta name="keywords" content="種類">
    <!-- InstanceEndEditable -->
</head>

<body>
	<nav class="navbar navbar-fixed-top navbar-inverse">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
					<span class="sr-only">メニュー開閉</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a href="../../index.htm"><img src="../../img/rdr2018-32.png" class="rdricon" alt="プロデル"></a>
				<a class="navbar-brand" href="#">
					<!-- InstanceBeginEditable name="HeaderTitle" -->WindowsMediaPlayer部品<!-- InstanceEndEditable -->
				</a>
			</div>
			<div id="navbar" class="collapse navbar-collapse">
				<ul class="nav navbar-nav navbar-right">
					<li id="cat_top"><a href="../../index.htm">目次</a></li>
					<li id="cat_syntax"><a href="../../syntax/index.htm">言語仕様</a></li>
					<li id="cat_lookup"><a href="../../lookup/index.htm">逆引き辞典</a></li>
					<li id="cat_datatype"><a href="../../primitive/index.htm">データ型</a></li>
					<li id="cat_gui" class="hidden-sm"><a href="../../wincontrol/index.htm">GUI部品</a></li>
					<li id="cat_verbs" class="hidden-sm"><a href="../../verbs/index.html">手順一覧</a></li>
					<li id="cat_devenv" class="hidden-sm"><a href="../../devenv/index.html">開発環境</a></li>
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">機能別 <span class="caret"></span></a>
						<ul class="dropdown-menu">
							<li id="cat_core"><a href="../../core/index.htm">基本機能</a></li>
							<li id="cat_file"><a href="../../file/index.htm">ファイル操作</a></li>
							<li id="cat_graphics"><a href="../../pgraphics/index.htm">画像描画</a></li>
							<li id="cat_office"><a href="../../office/index.htm">Microsoft Office操作</a></li>
							<li id="cat_data"><a href="../../data/index.htm">データ形式/データベース</a></li>
							<li id="cat_net"><a href="../../network/index.htm">ネットワーク</a></li>
							<li id="cat_mail"><a href="../../network/mail/index.htm">メール</a></li>
							<li class="divider"></li>
							<li id="cat_system"><a href="../systeminfo/index.htm">システム情報取得</a></li>
							<li id="cat_media"><a href="../multimedia/index.htm">メディア再生制御</a></li>
							<li id="cat_crypto"><a href="../crypto/index.htm">暗号化/ハッシュ計算</a></li>
							<li id="cat_speech"><a href="../speech/index.htm">音声処理</a></li>
							<li id="cat_reflection"><a href="../../core/reflection/index.htm">リフレクション</a></li>
							<li id="cat_msil"><a href="../msil/index.htm">MSIL生成</a></li>
							<li><a href="../../tools/web/index.htm">Webアプリ</a></li>
							<li class="divider"></li>
							<li><a href="../../wincontrol/index.htm">GUI部品</a></li>
							<li><a href="../../verbs/index.html">手順一覧</a></li>
							<li><a href="../../devenv/index.html">開発環境</a></li>
						</ul>
					</li>
				</ul>
			</div><!-- /.nav-collapse -->
		</div><!-- /.container -->
	</nav><!-- /.navbar -->

	<div id="main" class="container-fluid">
<!-- InstanceBeginEditable name="Content" -->
<div class="row">
<div id="reftitle" class="col-md-12">
	<div class="navigation">
        <ul class="breadcrumb" data-category="wmp">
			<li><a href="../../index.htm">プロデル</a></li>
            <li><a href="index.htm">WMPプラグイン</a></li>
            <li>WindowsMediaPlayer部品</li>
        </ul>
	</div>
	<h1>WindowsMediaPlayer部品</h1>
</div>
	<div id="refsidebar" class="col-md-3">
		<p><a href="../../static.htm" class="label label-info">静的種類</a></p>
		<ul class="jumpnavi nav nav-pills"><li><a href="#head">概要</a></li><li><a href="#サンプルコード">サンプルコード</a></li></ul>
        <h3>利用プラグイン</h3>
        <p><a href="index.htm">WMPプラグイン</a></p>
	</div>
<div id="refcontent" class="col-md-8">
        <h2>概要</h2>
	<p>「WindowsMediaPlayer部品」は、ウィンドウ上に貼り付けることができる
		Windows Media Player風のデザインのウィンドウ部品です。</p>
	<p>ビデオ映像を再生したり、スライダで再生位置を調整したり、各種ボタンを利用することができます。
		なお、再生できるエンコードは、WindowsMediaPlayerで再生できるものに依存します。
		一部動画は、別途コーデックをインストールする必要があり、環境によって再生できないことがあります。</p>
	<p>
	<img border="0" src="img/control.png" width="63" height="22" alt="ウィンドウ部品"></p>
	<h3>必要プラグイン</h3>
	<p>Windows Media Playerプラグイン（<a href="index.htm">Produire.WMP.dll</a>）　</p>
	<h2><a name="手順">手順</a></h2>
	<div id="methodlist"><a href="#再生する">再生する</a>　<a href="#一時停止する">一時停止する</a>　<a href="#停止する">停止する</a>　<a href="#次へ進む">次へ進む</a>　<a href="#前へ戻る">前へ戻る</a>　</div>
	<div id="methods">
		<h3>【自分】を、<a name="再生する">再生する</a></h3>
		<p>現在メディアを再生します。</p>
		<h3>【自分】を、<a name="一時停止する">一時停止する</a></h3>
		<p>一時停止します。</p>
		<h3>【自分】を、<a name="停止する">停止する</a></h3>
		<p>停止します。</p>
		<h3>【自分】を、<a name="次へ進む">次へ進む</a></h3>
		<p>次のメディアを再生します。</p>
		<h3>【自分】を、<a name="前へ戻る">前へ戻る</a></h3>
		<p>前のメディアを再生します。</p>
	</div>
	<p>　</p>
	<h2><a name="設定項目">設定項目</a></h2>
	<div id="properties">
		<table class="table table-bordered">
            <thead>
			<tr>
				<th class="column">設定項目</th>
				<th>型</th>
				<th>　</th>
				<th class="column">説明</th>
			</tr>
            </thead>
            <tbody>
			<tr>
				<th><a name="アドレス">アドレス</a></th>
				<th>文字列</th>
				<th>◎</th>
				<td>メディアがある位置を表すアドレス(URL)</td>
			</tr>
			<tr>
				<th><a name="再生位置">再生位置</a></th>
				<th>整数</th>
				<th>◎</th>
				<td>メディアの再生位置</td>
			</tr>
			<tr>
				<th><a name="再生位置情報">再生位置情報</a></th>
				<th>浮動小数</th>
				<th>□</th>
				<td>メディアの再生位置を表す文字列表現を返します</td>
			</tr>
			<tr>
				<th><a name="現在メディア">現在メディア</a></th>
				<th><a href="mediainfo.htm">メディア情報</a></th>
				<th>□</th>
				<td>再生中のメディア</td>
			</tr>
			<tr>
				<th><a name="コンテキストメニュー">コンテキストメニュー</a></th>
				<th>真偽値</th>
				<th>◎</th>
				<td>WindowsMediaPlayer標準のコンテキストメニューを表示するかどうか</td>
			</tr>
			<tr>
				<th><a name="フルスクリーン">フルスクリーン</a></th>
				<th>真偽値</th>
				<th>◎</th>
				<td>フルスクリーンで表示するかどうか</td>
			</tr>
			<tr>
				<th><a name="自動再生">自動再生</a></th>
				<th>真偽値</th>
				<th>◎</th>
				<td>メディアを開くとすぐに再生を開始するかどうか</td>
			</tr>
			<tr>
				<th><a name="バランス">バランス</a></th>
				<th>整数</th>
				<th>◎</th>
				<td>ステレオ音声のバランス（-100～100）</td>
			</tr>
			<tr>
				<th><a name="音量">音量</a></th>
				<th>整数</th>
				<th>◎</th>
				<td>音量（0～100）</td>
			</tr>
			<tr>
				<th><a name="消音">消音</a></th>
				<th>真偽値</th>
				<th>◎</th>
				<td>消音(ミュート)状態にするかどうか</td>
			</tr>
			<tr>
				<th><a name="速度">速度</a></th>
				<th>浮動小数</th>
				<th>◎</th>
				<td>再生速度(倍速)(標準が1)<br>
				WMV,ASFは、1～10または-1～-10(逆再生)<br>
				その他のビデオ形式は、0～9、1以下はスロー再生</td>
			</tr>
			<tr>
				<th><a name="エラー表示">エラー表示</a></th>
				<th>真偽値</th>
				<th>◎</th>
				<td>WindowsMediaPlayer標準のエラーメッセージを表示するかどうか</td>
			</tr>
			<tr>
				<th><a name="状態">状態</a></th>
				<th>文字列</th>
				<th>□</th>
				<td>プレーヤの状態</td>
			</tr>
			<tr>
				<th><a name="再生状態">再生状態</a></th>
				<th>列挙</th>
				<th>◎</th>
				<td>プレーヤの再生状態<br>｛再生中，停止中，バッファリング中，一時停止中，準備完了，再生終了，再接続中，待機中｝</td>
			</tr>
			<tr>
				<th><a name="画面状態">画面状態</a></th>
				<th>列挙</th>
				<th>◎</th>
				<td>部品のサイズ<br>｛なし，最小，フル，カスタム｝</td>
			</tr>
            </tbody>
		</table>
	</div>
	<p>&nbsp;</p>
	<h2><a name="イベント手順">イベント手順</a></h2>
	<p>次のイベント手順が使用できます。</p>
	<div id="events">
		<table class="table table-bordered">
            <thead>
			<tr>
				<th>イベント名</th>
				<th>説明</th>
				<th>情報</th>
			</tr>
            </thead>
            <tbody>
			<tr>
				<th><a name="状態が変更された">状態が変更された</a></th>
				<td>プレーヤの状態が変更された時</td>
				<td></td>
			</tr>
			<tr>
				<th><a name="再生状態が変更された">再生状態が変更された</a></th>
				<td>プレーヤの再生状態が変更された時</td>
				<td></td>
			</tr>
			<tr>
				<th><a name="現在メディアが変更された">現在メディアが変更された</a></th>
				<td>プレーヤで開いているメディアが変更された時</td>
				<td></td>
			</tr>
			<tr>
				<th><a name="メディア情報が変更された">メディア情報が変更された</a></th>
				<td>開いているメディアについての情報が変更された時</td>
				<td></td>
			</tr>
			<tr>
				<th><a name="再生位置が変更された">再生位置が変更された</a></th>
				<td>再生位置が変更された時</td>
				<td><a href="positionchangeevent.htm">あり</a></td>
			</tr>
            </tbody>
		</table>
	</div>
	<p>&nbsp;</p>
	<h2 id="サンプルコード">サンプルコード</h2>
    <div id="samples">
      <h3 id="sample1">Windows Media Player部品を使った簡易メディアプレーヤ</h3>
	<p>プロデルでWindows Media Playerコンポーネントを使った簡易メディアプレーヤです。<br>
	ウィンドウ上でビデオを再生したりすることができます。<br>
	また、リストビューで動画の情報を取得することができます。</p>
	<pre class="code" id="prg">「Produire.WMP.dll」を利用する
「Produire.WinControl.dll」を利用する
メイン画面を表示する
待機する

メイン画面とは
  ウィンドウを継承する

  はじめ手順
    初期化する
    WMPというWindowsMediaPlayer部品を作る
      その位置と大きさは｛10，50，310，200｝
      その位置固定方向は「右＋左＋下＋上」
    WMPを初期化する
    タイマー１というタイマーを作る
    タイマー１の&quot;間隔&quot;は1000
  終わり

初期化する手順
ーー//この手順は自動生成されたものです
ーー//編集しないでください
  この内部領域大きさは｛333，380｝
  この内容は「Windows Media Player On プロデル」
  このドラッグドロップは○
  この位置と大きさは｛15，15，349，418｝
  リストビュー1というリストビューを作る
    その表示方法は「詳細」
    その見出し一覧は｛「属性」，「値」｝
    その見出し幅は｛99，184｝
    その移動順は4
    その位置と大きさは｛9，256，314，112｝
    その位置固定方向は「右＋左＋下」
  開くボタンというボタンを作る
    その内容は「開く」
    その移動順は3
    その位置と大きさは｛96，9，83，27｝
  ラベル1というラベルを作る
    その内容は「00:00/00:00」
    その移動順は2
    その位置と大きさは｛12，16，63，12｝
終わり

  WMPのメディア情報が変更された時の手順
    リストビュー１をすべて消す
    WMPの現在メディアの属性一覧の見出しのすべての属性名について、それぞれ繰り返す
      リストビュー１に、属性名を追加する
          その詳細は｛(WMPの現在メディアから属性名という属性を取得したもの)｝
    そして
  終わり
  WMPの再生位置が変更された時の手順
    ラベル1の内容は「[WMPの再生位置情報]/[WMPの現在メディアの長さ情報]」
  終わり
  WMPの状態が変更された時の手順
    WMPの再生状態が「再生中」なら
      タイマー１を開始する
    そうでなければ
      タイマー１を停止する
    そして
  終わり
  タイマー１が時間になった時の手順
    ラベル1の内容は「[WMPの再生位置情報]/[WMPの現在メディアの長さ情報]」
  終わり

  開くボタンがクリックされた時の手順
    開く画面のフォルダ名は、マイミュージック
    開く画面のフィルタは「メディア|*.mpg;*.wmv;*.avi;*.mp3;*.wma;*.wav|すべてのファイル|*.*」
    開く画面を表示する
    開く画面のキャンセルなら、終了する
    ファイル名は、開く画面のファイル名
    WMPのアドレスは、ファイル名
    曲情報を更新する
  終わり

  曲情報を、更新する手順
    ラベル1の内容は「[WMPの再生位置情報]/[WMPの現在メディアの長さ情報]」
  終わり

終わり</pre>
    </div>
</div>
</div>

<!-- InstanceEndEditable -->
		<p id="page-top"><a href="#">ページ先頭へ</a></p>
		<footer>
    		<hr>
			<p class="text-muted text-right"><a href="https://produ.irelang.jp/">日本語プログラミング言語 プロデル</a> Ver.2.0 &copy; 2007-2025 irelang.jp</p>
		</footer>
	</div><!--/.container-->
	<script src="../../js/jquery-1.12.4.min.js"></script>
	<script src="../../js/bootstrap.min.js"></script>
	<script src="../../js/ie10-viewport-bug-workaround.js"></script>
	<script src="../../js/script.js"></script>
    <script src="../../js/syntax-highlight.js"></script>
<!-- InstanceBeginEditable name="Script" -->
<!-- InstanceEndEditable -->
</body>
<!-- InstanceEnd --></html>
