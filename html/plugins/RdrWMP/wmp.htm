<!doctype html>
<html lang="ja"><!-- InstanceBegin template="/Templates/reference2020.dwt" codeOutsideHTMLIsLocked="false" -->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- InstanceBeginEditable name="doctitle" -->
	<title>WindowsMediaPlayer</title>
<!-- InstanceEndEditable -->
	<link href="../../css/bootstrap.min.css" rel="stylesheet">
	<link href="../../css/style.css" rel="stylesheet">
	<link href="../../css/ie10-viewport-bug-workaround.css" rel="stylesheet">
	<script src="../../js/html5shiv-3.7.3.min.js"></script>
	<script src="../../js/respond-1.4.2.min.js"></script>
<!-- InstanceBeginEditable name="head" -->
<meta name="keywords" content="種類">
    <!-- InstanceEndEditable -->
</head>

<body>
	<nav class="navbar navbar-fixed-top navbar-inverse">
		<div class="container-fluid">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
					<span class="sr-only">メニュー開閉</span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
					<span class="icon-bar"></span>
				</button>
				<a href="../../index.htm"><img src="../../img/rdr2018-32.png" class="rdricon" alt="プロデル"></a>
				<a class="navbar-brand" href="#">
					<!-- InstanceBeginEditable name="HeaderTitle" -->WindowsMediaPlayer<!-- InstanceEndEditable -->
				</a>
			</div>
			<div id="navbar" class="collapse navbar-collapse">
				<ul class="nav navbar-nav navbar-right">
					<li id="cat_top"><a href="../../index.htm">目次</a></li>
					<li id="cat_syntax"><a href="../../syntax/index.htm">言語仕様</a></li>
					<li id="cat_lookup"><a href="../../lookup/index.htm">逆引き辞典</a></li>
					<li id="cat_datatype"><a href="../../primitive/index.htm">データ型</a></li>
					<li id="cat_gui" class="hidden-sm"><a href="../../wincontrol/index.htm">GUI部品</a></li>
					<li id="cat_verbs" class="hidden-sm"><a href="../../verbs/index.html">手順一覧</a></li>
					<li id="cat_devenv" class="hidden-sm"><a href="../../devenv/index.html">開発環境</a></li>
					<li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">機能別 <span class="caret"></span></a>
						<ul class="dropdown-menu">
							<li id="cat_core"><a href="../../core/index.htm">基本機能</a></li>
							<li id="cat_file"><a href="../../file/index.htm">ファイル操作</a></li>
							<li id="cat_graphics"><a href="../../pgraphics/index.htm">画像描画</a></li>
							<li id="cat_office"><a href="../../office/index.htm">Microsoft Office操作</a></li>
							<li id="cat_data"><a href="../../data/index.htm">データ形式/データベース</a></li>
							<li id="cat_net"><a href="../../network/index.htm">ネットワーク</a></li>
							<li id="cat_mail"><a href="../../network/mail/index.htm">メール</a></li>
							<li class="divider"></li>
							<li id="cat_system"><a href="../systeminfo/index.htm">システム情報取得</a></li>
							<li id="cat_media"><a href="../multimedia/index.htm">メディア再生制御</a></li>
							<li id="cat_crypto"><a href="../crypto/index.htm">暗号化/ハッシュ計算</a></li>
							<li id="cat_speech"><a href="../speech/index.htm">音声処理</a></li>
							<li id="cat_reflection"><a href="../../core/reflection/index.htm">リフレクション</a></li>
							<li id="cat_msil"><a href="../msil/index.htm">MSIL生成</a></li>
							<li><a href="../../tools/web/index.htm">Webアプリ</a></li>
							<li class="divider"></li>
							<li><a href="../../wincontrol/index.htm">GUI部品</a></li>
							<li><a href="../../verbs/index.html">手順一覧</a></li>
							<li><a href="../../devenv/index.html">開発環境</a></li>
						</ul>
					</li>
				</ul>
			</div><!-- /.nav-collapse -->
		</div><!-- /.container -->
	</nav><!-- /.navbar -->

	<div id="main" class="container-fluid">
<!-- InstanceBeginEditable name="Content" -->
<div class="row">
<div id="reftitle" class="col-md-12">
	<div class="navigation">
        <ul class="breadcrumb" data-category="wmp">
            <li><a href="index.htm">WMPプラグイン</a></li>
            <li>WindowsMediaPlayer</li>
        </ul>
	</div>
<h1>WindowsMediaPlayer</h1>
</div>
	<div id="refsidebar" class="col-md-3">
		<p><a href="../../static.htm" class="label label-info">静的種類</a></p>
		<ul class="jumpnavi nav nav-pills"><li><a href="#head">概要</a></li><li><a href="#サンプルコード">サンプルコード</a></li></ul>
        <h3>利用プラグイン</h3>
        <p><a href="index.htm">WMPプラグイン</a></p>
	</div>
<div id="refcontent" class="col-md-8">
        <h2>概要</h2>
	<p>「WindowsMediaPlayer」は、WindowsMediaPlayerの機能を使って、メディアを再生する種類です。</p>
	<p>
	<img border="0" src="img/creatable.png" width="63" height="22" alt="生成可能"></p>
	<h3>必要プラグイン</h3>
	<p>Windows Media Playerプラグイン（<a href="index.htm">Produire.WMP.dll</a>）　</p>
	<p>　</p>
	<h2><a name="手順">手順</a></h2>
	<div id="methodlist"><a href="#再生する">再生する</a>　<a href="#一時停止する">一時停止する</a>　<a href="#停止する">停止する</a>　<a href="#次へ進む">次へ進む</a>　<a href="#前へ戻る">前へ戻る</a>　</div>
	<div id="methods">
		<h3>【自分】を、<a name="再生する">再生する</a></h3>
		<p>現在メディアを再生します。</p>
		<h3>【自分】を、<a name="一時停止する">一時停止する</a></h3>
		<p>一時停止します。</p>
		<h3>【自分】を、<a name="停止する">停止する</a></h3>
		<p>停止します。</p>
		<h3>【自分】を、<a name="次へ進む">次へ進む</a></h3>
		<p>次のメディアを再生します。</p>
		<h3>【自分】を、<a name="前へ戻る">前へ戻る</a></h3>
		<p>前のメディアを再生します。</p>
	</div>
	<p>　</p>
	<h2><a name="設定項目">設定項目</a></h2>
	<div id="properties">
		<table class="table table-bordered">
            <thead>
			<tr>
				<th>設定項目</th>
				<th>型</th>
				<th>　</th>
				<th>説明</th>
			</tr>
            </thead>
            <tbody>
			<tr>
				<th><a name="アドレス">アドレス</a></th>
				<th>文字列</th>
				<th>◎</th>
				<td>メディアがある位置を表すアドレス(URL)</td>
			</tr>
			<tr>
				<th><a name="再生位置">再生位置</a></th>
				<th>整数</th>
				<th>◎</th>
				<td>メディアの再生位置</td>
			</tr>
			<tr>
				<th><a name="再生位置情報">再生位置情報</a></th>
				<th>浮動小数</th>
				<th>□</th>
				<td>メディアの再生位置を表す文字列表現を返します</td>
			</tr>
			<tr>
				<th><a name="現在メディア">現在メディア</a></th>
				<th><a href="mediainfo.htm">メディア情報</a></th>
				<th>□</th>
				<td>再生中のメディア</td>
			</tr>
			<tr>
				<th><a name="自動再生">自動再生</a></th>
				<th>真偽値</th>
				<th>◎</th>
				<td>メディアを開くとすぐに再生を開始するかどうか</td>
			</tr>
			<tr>
				<th><a name="バランス">バランス</a></th>
				<th>整数</th>
				<th>◎</th>
				<td>ステレオ音声のバランス（-100～100）</td>
			</tr>
			<tr>
				<th><a name="音量">音量</a></th>
				<th>整数</th>
				<th>◎</th>
				<td>音量（0～100）</td>
			</tr>
			<tr>
				<th><a name="消音">消音</a></th>
				<th>真偽値</th>
				<th>◎</th>
				<td>消音(ミュート)状態にするかどうか</td>
			</tr>
			<tr>
				<th><a name="速度">速度</a></th>
				<th>浮動小数</th>
				<th>◎</th>
				<td>再生速度(倍速)(標準が1)<br>
				WMV,ASFは、1～10または-1～-10(逆再生)<br>
				その他のビデオ形式は、0～9、1以下はスロー再生</td>
			</tr>
			<tr>
				<th><a name="エラー表示">エラー表示</a></th>
				<th>真偽値</th>
				<th>◎</th>
				<td>WindowsMediaPlayer標準のエラーメッセージを表示するかどうか</td>
			</tr>
			<tr>
				<th><a name="状態">状態</a></th>
				<th>文字列</th>
				<th>□</th>
				<td>プレーヤの状態</td>
			</tr>
			<tr>
				<th><a name="再生状態">再生状態</a></th>
				<th>列挙</th>
				<th>◎</th>
				<td>プレーヤの再生状態<br>｛再生中，停止中，バッファリング中，一時停止中，準備完了，再生終了，再接続中，待機中｝</td>
			</tr>
            </tbody>
		</table>
	</div>
	<p>&nbsp;</p>
	<h2><a name="イベント手順">イベント手順</a></h2>
	<p>次のイベント手順が使用できます。</p>
	<div id="events">
		<table class="table table-bordered">
            <thead>
			<tr>
				<th>イベント名</th>
				<th>説明</th>
				<th>情報</th>
			</tr>
            </thead>
            <tbody>
			<tr>
				<th><a name="状態が変更された">状態が変更された</a></th>
				<td>プレーヤの状態が変更された時</td>
				<td></td>
			</tr>
			<tr>
				<th><a name="再生状態が変更された">再生状態が変更された</a></th>
				<td>プレーヤの再生状態が変更された時</td>
				<td></td>
			</tr>
			<tr>
				<th><a name="現在メディアが変更された">現在メディアが変更された</a></th>
				<td>プレーヤで開いているメディアが変更された時</td>
				<td></td>
			</tr>
			<tr>
				<th><a name="メディア情報が変更された">メディア情報が変更された</a></th>
				<td>開いているメディアについての情報が変更された時</td>
				<td></td>
			</tr>
			<tr>
				<th><a name="再生位置が変更された">再生位置が変更された</a></th>
				<td>再生位置が変更された時</td>
				<td>&nbsp;</td>
			</tr>
            </tbody>
		</table>
	</div>
	<p>&nbsp;</p>
	<h2 id="サンプルコード">サンプルコード</h2>
	<p>プロデルでWindows Media Playerコンポーネントを使って、音楽ファイルを再生します。</p>
	<pre class="code" id="prg">「Produire.WMP.dll」を利用する
「Produire.WinControl.dll」を利用する
メイン画面を表示する
待機する

メイン画面とは
  ウィンドウを継承する
  +タイマー１

  はじめの手順
    初期化する
    タイマー１というタイマーを作る
    タイマー１の&quot;間隔&quot;は500
    WMPというWindowsMediaPlayerを作る
    WMPの音量は100
    再生ボタンを有効にする
    一時停止ボタンを無効にする
    停止ボタンを無効にする
  終わり

初期化する手順
ーー//この手順は自動生成されたものです
ーー//編集しないでください
  この内部領域大きさは｛270，182｝
  この内容は「メディアプレーヤのテスト」
  このドラッグドロップは○
  この位置と大きさは｛15，15，286，220｝
  ラベル2というラベルを作る
    その内容は「なし」
    その移動順は7
    その位置と大きさは｛20，48，24，12｝
  開くボタンというボタンを作る
    その内容は「開く」
    その移動順は6
    その位置と大きさは｛93，7，75，23｝
  ラベル1というラベルを作る
    その内容は「00:00/00:00」
    その移動順は5
    その位置と大きさは｛20，12，63，12｝
  スライダ1というスライダを作る
    その目盛り間隔は30
    その最大値は60
    その大移動幅は10
    その移動順は4
    その位置と大きさは｛12，78，237，45｝
    その位置固定方向は「右＋左＋上」
  一時停止ボタンというボタンを作る
    その内容は「一時停止」
    その移動順は3
    その位置と大きさは｛93，147，75，23｝
  停止ボタンというボタンを作る
    その内容は「停止」
    その移動順は1
    その位置と大きさは｛174，147，75，23｝
  再生ボタンというボタンを作る
    その内容は「再生」
    その移動順は2
    その位置と大きさは｛12，147，75，23｝
終わり

  再生ボタンがクリックされた時の手順
    WMPを再生する
  終わり

  停止ボタンがクリックされた時の手順
    WMPを停止する
  終わり

  一時停止ボタンがクリックされた時の手順
    WMPを一時停止する
  終わり

  WMPの再生状態が変更された時の手順
    WMPの再生状態について分岐
    「再生中」の場合
      再生ボタンを無効にする
      一時停止ボタンを有効にする
      停止ボタンを無効にする
    「一時停止中」の場合
      再生ボタンを有効にする
      一時停止ボタンを無効にする
      停止ボタンを有効にする
    「停止中」の場合
      再生ボタンを有効にする
      一時停止ボタンを無効にする
      停止ボタンを無効にする
    そして
    WMPの再生状態が「再生中」なら
      タイマー１を開始する
    そうでなければ
      タイマー１を停止する
    そして
  終わり
  WMPの現在メディアが変更された時の手順
    スライダ1の最大値は（WMPの現在メディアの長さ*10）の整数
  終わり

  タイマー１が時間になった時の手順
    WMPの現在メディアが無なら、抜け出す
    スライダ1の最大値が0でなければ
      スライダ1の値は（WMPの再生位置*10）の整数
    そして
    曲情報を更新する
  終わり

  スライダ1が変化した時の手順
    WMPの再生位置は、スライダ1の値/10
  終わり

  開くボタンがクリックされた時の手順
    開く画面のフォルダ名は、マイミュージック
    開く画面のフィルタは「メディア|*.mp3;*.wma;*.wav|すべてのファイル|*.*」
    開く画面を表示する
    開く画面のキャンセルなら、終了する
    ファイル名は、開く画面のファイル名
    WMPのアドレスは、ファイル名
    曲情報を更新する
  終わり

  曲情報を、更新する手順
    スライダ1の最大値は（WMPの現在メディアの長さ*10）の整数
    ラベル1の内容は「[WMPの再生位置情報]/[WMPの現在メディアの長さ情報]」
    ラベル2の内容は「アーティスト: [WMPの現在メディアから「DisplayArtist」という属性を取得したもの]　タイトル:  	[WMPの現在メディアから「Title」という属性を取得したもの]」
  終わり
終わり</pre>
	<p>　</p>
</div>
</div>

<!-- InstanceEndEditable -->
		<p id="page-top"><a href="#">ページ先頭へ</a></p>
		<footer>
    		<hr>
			<p class="text-muted text-right"><a href="https://produ.irelang.jp/">日本語プログラミング言語 プロデル</a> Ver.2.0 &copy; 2007-2025 irelang.jp</p>
		</footer>
	</div><!--/.container-->
	<script src="../../js/jquery-1.12.4.min.js"></script>
	<script src="../../js/bootstrap.min.js"></script>
	<script src="../../js/ie10-viewport-bug-workaround.js"></script>
	<script src="../../js/script.js"></script>
    <script src="../../js/syntax-highlight.js"></script>
<!-- InstanceBeginEditable name="Script" -->
<!-- InstanceEndEditable -->
</body>
<!-- InstanceEnd --></html>
